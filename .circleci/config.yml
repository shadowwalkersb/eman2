version: 2

jobs:
  boost=1.64:
    docker:
      - image: circleci/buildpack-deps:16.04
    steps:
      - checkout
      - restore_cache:
          keys: mini-eman-deps-15.2-boost-1.64-build-1
      - run:
          command: |
            source ${HOME}/miniconda3/bin/activate base
            conda remove zstd --yes
            conda list
            conda clean --all --yes
      - save_cache:
          key: mini-eman-deps-18.0-{{ .Environment.CIRCLE_JOB }}-0
          paths:
            - ~/miniconda3

  boost=1.65:
    docker:
      - image: circleci/buildpack-deps:16.04
    steps:
      - checkout
      - restore_cache:
          keys: mini-eman-deps-15.2-boost-1.65-build-1
      - run:
          command: |
            source ${HOME}/miniconda3/bin/activate base
            conda remove zstd --yes
            conda list
            conda clean --all --yes
      - save_cache:
          key: mini-eman-deps-18.0-{{ .Environment.CIRCLE_JOB }}-0
          paths:
            - ~/miniconda3

  boost=1.66:
    docker:
      - image: circleci/buildpack-deps:16.04
    steps:
      - checkout
      - restore_cache:
          keys: mini-eman-deps-15.2-boost-1.66-build-1
      - run:
          command: |
            source ${HOME}/miniconda3/bin/activate base
            conda remove zstd --yes
            conda list
            conda clean --all --yes
      - save_cache:
          key: mini-eman-deps-18.0-{{ .Environment.CIRCLE_JOB }}-0
          paths:
            - ~/miniconda3

  boost=1.67:
    docker:
      - image: circleci/buildpack-deps:16.04
    steps:
      - checkout
      - restore_cache:
          keys: mini-eman-deps-15.2-boost-1.67-build-1
      - run:
          command: |
            source ${HOME}/miniconda3/bin/activate base
            conda remove zstd --yes
            conda list
            conda clean --all --yes
      - save_cache:
          key: mini-eman-deps-18.0-{{ .Environment.CIRCLE_JOB }}-0
          paths:
            - ~/miniconda3

  boost=1.68:
    docker:
      - image: circleci/buildpack-deps:16.04
    steps:
      - checkout
      - restore_cache:
          keys: mini-eman-deps-15.2-boost-1.68-build-1
      - run:
          command: |
            source ${HOME}/miniconda3/bin/activate base
            conda remove zstd --yes
            conda list
            conda clean --all --yes
      - save_cache:
          key: mini-eman-deps-18.0-{{ .Environment.CIRCLE_JOB }}-0
          paths:
            - ~/miniconda3

  boost=1.69:
    docker:
      - image: circleci/buildpack-deps:16.04
    steps:
      - checkout
      - restore_cache:
          keys: mini-eman-deps-15.2-boost-1.69-build-1
      - run:
          command: |
            source ${HOME}/miniconda3/bin/activate base
            conda remove zstd --yes
            conda list
            conda clean --all --yes
      - save_cache:
          key: mini-eman-deps-18.0-{{ .Environment.CIRCLE_JOB }}-0
          paths:
            - ~/miniconda3

  boost=1.70:
    docker:
      - image: circleci/buildpack-deps:16.04
    steps:
      - checkout
      - restore_cache:
          keys: mini-eman-deps-15.2-boost-1.70-build-1
      - run:
          command: |
            source ${HOME}/miniconda3/bin/activate base
            conda remove zstd --yes
            conda list
            conda clean --all --yes
      - save_cache:
          key: mini-eman-deps-18.0-{{ .Environment.CIRCLE_JOB }}-0
          paths:
            - ~/miniconda3


workflows:
  version: 2
  setup_cache_boost:
    jobs:
      - boost=1.64
      - boost=1.65
      - boost=1.66
      - boost=1.67
      - boost=1.68
      - boost=1.69
